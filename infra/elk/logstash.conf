input {
  beats {
    port => 5044
  }
}

filter {
  # Parse JSON messages from Spring Boot's LogstashEncoder
  json {
    source => "message"
    # If your logs are already JSON, you might not need this.
    # But if LogstashEncoder puts JSON inside the 'message' field, this is needed.
    # The LogstashEncoder usually puts the JSON fields at the root, so this filter might be optional
    # depending on how Filebeat sends the logs.
  }

  # Add a field to identify the source of the logs (optional but good practice)
  mutate {
    add_field => { "[@metadata][beat_type]" => "filebeat" }
  }
}

output {
  elasticsearch {
    hosts => ["http://elasticsearch:9200"]
    index => "cou-commerce-%{+YYYY.MM.dd}"
    # user => "elastic" # If you enable security in Elasticsearch
    # password => "changeme"
  }
  # Optional: Output to stdout for debugging Logstash pipeline
  # stdout { codec => rubydebug }
}
